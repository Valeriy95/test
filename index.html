<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="assets/favicon.ico" rel="shortcut icon" />
  <link rel="stylesheet" href="css/owfont-regular.css" />
  <link rel="stylesheet" href="css/style.css" />
  <title>momentum</title>
  <script>
  const todoInput = document.querySelector(".todo-input input");
const btnPenComp = document.querySelectorAll(".btn-pen-comp span");
const list = document.querySelector(".list-container");
const clearBtn = document.querySelector(".btn-clear");
const progressBtn = document.querySelector(".progress-btn");
const doneBtn = document.querySelector(".done-btn");

let editNumber;
let isEditedInput = false;
let todoListArr = JSON.parse(localStorage.getItem("todoList"));

progressBtn.addEventListener("click", () => {
   progressBtn.classList.add("active");
   doneBtn.classList.remove("active");
   showList("progress");
});

doneBtn.addEventListener("click", () => {
   doneBtn.classList.add("active");
   progressBtn.classList.remove("active");
   showList("done");
});

function showList(btn) {
   let li = "";
   if(todoListArr) {
      todoListArr.forEach((value, index) => {
         let isDone = value.status == "done" ? "checked" : "";
         if(btn == value.status) {
            li += `<li class="item ">
                     <label for="${index}">
                        <input onclick="status()" type="checkbox" id="${index}" ${isDone}>
                        <p class="${isDone}">${value.name}</p>
                     </label>
                     <div class="settings-todo">
                        <p onclick="showMenu(this)">...</p>
                        <ul class="item-menu">
                           <li onclick="editInput(${index}, '${value.name}')">Edit</li>
                           <li onclick="deleteInput(${index})">Delete</li>
                        </ul>
                     </div>
                  </li>`;
         }
      });
   }
   list.innerHTML = li || `<span>No todos yet</span>`;
}
showList("progress");

function showMenu(selected) {
   let containerMenu = selected.parentElement.lastElementChild;
   containerMenu.classList.add("show");
   document.addEventListener("click", e => {
      if(e.target.tagName != "P" || e.target != selected) {
         containerMenu.classList.remove("show");
      }
   })
}

function editInput(taskNumber, valueName) {
   editNumber = taskNumber;
   isEditedInput = true;
   todoInput.value = valueName;
}

function deleteInput(deleteNumber) {
   todoListArr.splice(deleteNumber, 1);
   localStorage.setItem("todoList", JSON.stringify(todoListArr));
   showList("progress");
} 

clearBtn.addEventListener("click", () => {
   todoListArr.splice(0, todoListArr.length);
   localStorage.setItem("todoList", JSON.stringify(todoListArr));
   showList("progress");
});

function status(selected) {
   let blocName = selected.parentElement.lastElementChild;
   if(selected.checked) {
      blocName.classList.add("checked");
      todoListArr[selected.id].status = "done";
   } else {
      blocName.classList.remove("checked");
      todoListArr[selected.id].status = "progress";
   }
   localStorage.setItem("todoList", JSON.stringify(todoListArr)); 
};

todoInput.addEventListener("keyup", e => {
   let userInput = todoInput.value.trim();
   if(e.key == "Enter" && userInput) {
      if(!isEditedInput) {
         if (!todoListArr) {
            todoListArr = [];
         }
         let userInfo = {name: userInput, status: "progress"};
         todoListArr.push(userInfo);
      } else {
         isEditedInput = false;
         todoListArr[editNumber].name = userInput;
      }
      todoInput.value = "";
      localStorage.setItem("todoList", JSON.stringify(todoListArr));
      progressBtn.classList.add("active");
      doneBtn.classList.remove("active");
      showList("progress");
   }
});
  </script>
</head>
<body>
  <header class="header">
    <div class="player">
      <div class="player-controls">
        <button class="play-prev player-icon"></button>
        <button class="play player-icon"></button>
        <button class="play-next player-icon"></button>
      </div>
      <ul class="play-list"></ul>
    </div>
    <div class="wrapper-player hidden">
      <div class="song-name"></div>
      <div class="wrapper-player1">
        <button class="play-prev player-icon btn-prev-pl"></button>
        <button class="play player-icon btn-play-pl"></button>
        <button class="play-next player-icon btn-next-pl"></button>
        <div class="progress-container">
          <div class="progress"></div>
        </div>
        <div class="song-duraction"></div>
        <div class="volume"></div>
        <input class="range" min="0" max="100" value="50" type="range">
      </div>
    </div>
    <div class="weather">
      <input type="text" class="city" />
      <i class="weather-icon owf"></i>
      <div class="weather-error"></div>
      <div class="description-container">
        <span class="temperature"></span>
        <span class="weather-description"></span>
      </div>
      <div class="wind"></div>
      <div class="humidity"></div>
    </div>
  </header>
  <main class="main">
    <div class="slider-icons">
      <button class="slide-prev slider-icon"></button>
      <button class="slide-next slider-icon"></button>
    </div>
    <time class="time"></time>
    <date class="date"></date>
    <div class="greeting-container">
      <span class="greeting"></span>
      <input type="text" class="names" value="[Enter name]"/>
    </div>
  </main>
  <footer class="footer">
    <button class="change-quote"></button>
    <div>
      <div class="quote"></div>
      <div class="author"></div>
      <div class="setting-icon"></div>
      <div class="setting-container">
        <div class="close-icon">
          <span class="close-icon1"></span>
          <span class="close-icon2"></span>
        </div>
        <div class='language-container'>
        <div class="languages">Language</div>
        <form action="langenru">
          <label>
            <span class='langBtnSet'><input name="lang" type="radio" value="en">English</span>
          </label>
          <label>
            <span class='langBtnSet'><input name="lang" type="radio" value="ru">Русский</span>
          </label>
        </form>
        </div>
        <div>
        <div class="image-collection">Image collection</div>
        <form class='imgBtn' action="imagecollection">
          <label>
            <span class='langBtnSet'><input name="imgcollection" type="radio" value="github">GitHub</span>
          </label>
          <div class='unsplash-container'>
          <label>
            <span class='langBtnSet'><input name="imgcollection" type="radio" value="unsplash">Unsplash API</span>
          </label>
            <div class='tagBtn1'>Tag</div>
          </div>
          <div class='flickr-container'>
          <label>
            <span class='langBtnSet'><input name="imgcollection" type="radio" value="flickr">Flickr API</span>
          </label>
          <div class='tagBtn2'>Tag</div>
          </div>
        </form>
        </div>
        <div>
          <div class="hide-block">Hide/show blocks</div>
          <div class="hide-block-container hidden">
            <div class='hide-bloc-close'>
              <span class='close-icon-hide1'></span>
              <span class='close-icon-hide2'></span>
            </div>
              <div>
                <label>
                  <span class='langBtnSet hide-bloc-mar'><input name="time" type="checkbox" value="time">Time</span>
                </label>
              </div>
              <div>
                <label>
                  <span class='langBtnSet hide-bloc-mar'><input name="date" type="checkbox" value="date">Date</span>
                </label>
              </div>
              <div>
                <label>
                  <span class='langBtnSet hide-bloc-mar'><input name="greeting" type="checkbox" value="greeting">Greeting</span>
                </label>
              </div>
              <div>
                <label>
                  <span class='langBtnSet hide-bloc-mar'><input name="quote" type="checkbox" value="quote">Quote</span>
                </label>
              </div>
              <div>
                <label>
                  <span class='langBtnSet hide-bloc-mar'><input name="weather" type="checkbox" value="weather">Weather</span>
                </label>
              </div>
              <div>
                <label>
                <span class='langBtnSet hide-bloc-mar'><input name="audio" type="checkbox" value="audio">Audio</span>
                </label>
              </div>
              <div>
                <label>
                  <span class='langBtnSet hide-bloc-mar'><input name="todolist" type="checkbox" value="todolist">Todolist</span>
                </label>
              </div>
          </div>
        </div>
      </div>
      <div class='todo-icon'></div>
      <div class="wrapper-todo hidden">
        <div class="todo-container">
          <div class="todo-input">
              <input type="text" placeholder="New ToDo">
          </div>
          <div class="buttons">
              <div class="btn-pen-comp">
                <span id="progress" class="progress-btn active">In progress</span>
                <span id="done" class="done-btn">Done</span>
              </div>
              <button class="btn-clear">Clear All</button>
          </div>
        </div>
        <ul class="list-container"></ul>
      </div>
  </footer>
<!--   <script type="module" src="index.js"></script> -->
  <script type="module" src="script.js"></script>
</body>
</html>
